#include <bits/stdc++.h>
using namespace std;

int n, k;
vector<pair<int,int>> pt;

bool work(int r){
    vector<vector<int>>diff(n+2, vector<int>(n+2, 0));
    for(auto &p:pt){
        int x=p.first;
        int y=p.second;
        int x1=max(1, x-r);
        int x2=min(n, x+r);
        int y1=max(1, y-r);
        int y2=min(n, y+r);

        if(x1>x2||y1>y2){
            continue;
        }

        diff[x1][y1]=diff[x1][y1]+1;
        diff[x1][y2+1]=diff[x1][y2+1]-1;
        diff[x2+1][y1]=diff[x2+1][y1]-1;
        diff[x2+1][y2+1]=diff[x2+1][y2+1]+1;
    }

    for(int i=1;i<=n;i++){
        for(int j=1; j<=n; j++){
            diff[i][j]=diff[i][j]+diff[i-1][j]+diff[i][j-1]-diff[i-1][j-1];
            if (diff[i][j]==0){
                return false;
            } 
        }
    }
    return true;
}

int main(){
    int t;
    cin>>t;
    while(t--){
        cin>>n>>k;
        pt.clear();
        pt.reserve(k);
        for(int i = 0; i<k; i++){
            int x, y;
            cin>>x>>y;
            pt.emplace_back(x, y);
        }

        int l=0, h=n; 
        while(l<h){
            int mid=l+(h-l)/2;
            if(work(mid)){
                h=mid;
            }
            else{
                l=mid+1;
            }
        }
        cout<<l<<endl;
    }
    
}
